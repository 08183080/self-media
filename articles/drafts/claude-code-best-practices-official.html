<!doctype html>
<html style="    ">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Claude Code 最佳实践：把 AI 编程助手用到刀刃上</title>
  <meta name="author" content="谢苹果">
  <meta name="description" content="基于 Claude Code 官方文档，提炼出几条被内部和外部工程师验证过的心法：先探索再编码、写好 CLAUDE.md、管好上下文、用好 subagents，以及如何避开常见失败模式。">
  
</head>
<body style="padding: 24px; background: #ffffff; max-width: 860px; margin: 0 auto; font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif; font-size: 16px; line-height: 1.75; text-align: left;">
  <div id="output">
<section class="container" style="font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif; font-size: 16px; line-height: 1.75; text-align: left;"><hr class="hr" style="height: 1px; border: none; margin: 2em 0; background: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0)); margin-top: 0 !important;"><h1 class="h1" data-heading="true" style="padding: 0.5em 1em; font-size: calc(16px * 1.4); text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.05);">Claude Code 最佳实践：把 AI 编程助手用到刀刃上</h1><blockquote class="blockquote" style="margin-top: 0; margin-right: 0; margin-bottom: 0; margin-left: 0; font-style: italic; padding: 1em 1em 1em 2em; color: rgba(0, 0, 0, 0.6); border-bottom: 0.2px solid rgba(0, 0, 0, 0.04); border-top: 0.2px solid rgba(0, 0, 0, 0.04); border-right: 0.2px solid rgba(0, 0, 0, 0.04);"><p class="p">Claude Code 不是等你问一句答一句的聊天机器人，而是能读文件、跑命令、改代码的代理。但自主性再强，也有一条学习曲线——官方文档里总结的最佳实践，能帮你少踩坑、多省心。</p></blockquote><hr class="hr" style="height: 1px; border: none; margin: 2em 0; background: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0));"><h2 class="h2" data-heading="true" style="padding: 0.3em 1.2em; font-size: calc(16px * 1.3); border-radius: 8px 24px 8px 24px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);">一、最重要的约束：上下文会满</h2><p class="p">大多数最佳实践都绕不开一个事实：<strong>Claude 的 context window 填得很快，填得越满，表现越差。</strong></p><p class="p">对话里的每条消息、读过的每个文件、每条命令输出，都在占用上下文。一次调试或一次代码库探索，很容易就吃掉几万 token。当窗口快满时，模型会开始「忘掉」早先的指令、更容易出错。</p><p class="p">所以有一条心法要刻在脑子里：<strong>context window 是你最该省着用的资源。</strong> 后面的技巧，很多都是为了在少占上下文的前提下，把事做对。</p><hr class="hr" style="height: 1px; border: none; margin: 2em 0; background: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0));"><h2 class="h2" data-heading="true" style="padding: 0.3em 1.2em; font-size: calc(16px * 1.3); border-radius: 8px 24px 8px 24px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);">二、给它「验收标准」，别只给任务</h2><p class="p">当 Claude 能自己验证结果——跑测试、对比截图、检查输出——表现会明显更好。没有明确成功标准时，它可能写出「看起来对、跑起来错」的代码，而你成了唯一的反馈回路，每个错误都要你亲自指出来。</p><p class="p">可以这样升级你的提示：</p>
        <section style="font-family: -apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif; font-size: 16px; line-height: 1.75; text-align: left; max-width: 100%; overflow: auto;">
          <table class="preview-table" style="margin-top: 0 !important;">
            <thead><th class="th">之前</th><th class="th">之后</th></thead>
            <tbody><tr class="tr"><td class="td">「实现一个验证邮箱的函数」</td><td class="td">「写一个 validateEmail 函数。要求：<a href="mailto:user@example.com" title="user@example.com" style="color: #576b95; text-decoration: none;">user@example.com</a> 为真，invalid 为假，user@.com 为假。实现后跑一遍这些用例。」</td></tr><tr class="tr"><td class="td">「让仪表板好看点」</td><td class="td">「[贴设计图] 按这个实现。做完后截一张图跟原设计对比，列出差异并修掉。」</td></tr><tr class="tr"><td class="td">「构建挂了」</td><td class="td">「构建报错：[贴错误]。请修好并确认构建通过。要解决根因，不要只把报错压下去。」</td></tr></tbody>
          </table>
        </section>
      <p class="p">UI 改动可以配合浏览器里的 Claude 扩展做验证；后端逻辑就用测试、linter 或简单的 Bash 检查。<strong>在「可验证」上多花一点心思，后面会省很多时间。</strong></p><hr class="hr" style="height: 1px; border: none; margin: 2em 0; background: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0));"><h2 class="h2" data-heading="true" style="padding: 0.3em 1.2em; font-size: calc(16px * 1.3); border-radius: 8px 24px 8px 24px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);">三、先探索，再规划，最后再编码</h2><p class="p">一上来就写代码，很容易解决错问题。官方推荐用 <strong>Plan Mode</strong> 把「探索」和「执行」分开，流程大致是：</p><ol class="ol" style="padding-left: 1.5em;"><li class="listitem" style="margin: 0.5em 8px;">1. <strong>探索</strong>：理解代码库、依赖、现有模式；</li><li class="listitem" style="margin: 0.5em 8px;">2. <strong>规划</strong>：在不动代码的前提下，想清楚要改什么、怎么改；</li><li class="listitem" style="margin: 0.5em 8px;">3. <strong>编码</strong>：按规划一步步改。</li></ol><p class="p">这样能减少「写了一大段发现方向错了」的情况，也避免探索阶段读太多文件把上下文塞满。</p><hr class="hr" style="height: 1px; border: none; margin: 2em 0; background: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0));"><h2 class="h2" data-heading="true" style="padding: 0.3em 1.2em; font-size: calc(16px * 1.3); border-radius: 8px 24px 8px 24px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);">四、提示里给足「具体上下文」</h2><p class="p">Claude 能推断意图，但不会读心。要说清：<strong>哪个文件、什么场景、参考什么模式。</strong></p><ul class="ul" style="list-style: none; padding-left: 1.5em;"><li class="listitem" style="margin: 0.5em 8px;">• <strong>限定范围</strong>：不是「给 foo.py 加测试」，而是「给 foo.py 写测试，覆盖用户已登出的边界情况，尽量少用 mock」。</li><li class="listitem" style="margin: 0.5em 8px;">• <strong>指向来源</strong>：不是「ExecutionFactory 的 API 为啥这么怪」，而是「看 ExecutionFactory 的 git 历史，总结它的 API 是怎么演变成现在这样的」。</li><li class="listitem" style="margin: 0.5em 8px;">• <strong>引用现有模式</strong>：不是「加个日历组件」，而是「先看主页上现有组件的写法，以 HotDogWidget.php 为参考，按同样模式实现日历组件：选月份、前后翻页选年份，只用项目里已有的库」。</li><li class="listitem" style="margin: 0.5em 8px;">• <strong>描述症状</strong>：不是「登录有问题」，而是「用户反馈会话超时后登录失败。请检查 src/auth/ 下的认证流程，尤其是 token 刷新；先写一个能复现的失败测试，再修。」</li></ul><p class="p">拿不准时，可以用「@文件路径」直接引用文件，或贴截图、贴错误信息、贴日志。<strong>信息越具体，一次做对的概率越高。</strong></p><hr class="hr" style="height: 1px; border: none; margin: 2em 0; background: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0));"><h2 class="h2" data-heading="true" style="padding: 0.3em 1.2em; font-size: calc(16px * 1.3); border-radius: 8px 24px 8px 24px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);">五、写好 CLAUDE.md，等于给每次对话加「默认设定」</h2><p class="p">CLAUDE.md 是 Claude 每次对话都会读的特殊文件，适合写：<strong>构建/测试命令、代码风格、工作流约定</strong>——那些它光看代码很难猜出来的东西。用 <code class="codespan">/init</code> 可以让 Claude 先分析一遍项目，生成一个初版，你再按需精简、补充。</p><p class="p">原则是：<strong>短、好读、只写删掉就会导致犯错的内容。</strong></p><ul class="ul" style="list-style: none; padding-left: 1.5em;"><li class="listitem" style="margin: 0.5em 8px;">• 要写：它猜不到的 Bash 命令、和默认不一致的代码风格、你偏好的测试方式、仓库礼仪、关键架构决策、环境变量和常见坑。</li><li class="listitem" style="margin: 0.5em 8px;">• 不要写：能从代码里看出来的东西、长篇教程、逐文件介绍、经常变动的信息。</li></ul><p class="p">如果 CLAUDE.md 已经很长，模型容易忽略后半部分。像维护代码一样维护它：出错时回头看、定期删冗余、用「IMPORTANT」「YOU MUST」标出真正不能违反的规则。还可以用 <code class="codespan">@path/to/file</code> 把说明拆到别的文件里，保持主文件简短。</p><hr class="hr" style="height: 1px; border: none; margin: 2em 0; background: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0));"><h2 class="h2" data-heading="true" style="padding: 0.3em 1.2em; font-size: calc(16px * 1.3); border-radius: 8px 24px 8px 24px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);">六、权限、沙箱和「少点打断」</h2><p class="p">默认情况下，写文件、跑命令、用 MCP 等操作都会问你同意。问多了就容易变成无脑点「允许」。可以：</p><ul class="ul" style="list-style: none; padding-left: 1.5em;"><li class="listitem" style="margin: 0.5em 8px;">• <strong>权限白名单</strong>：把确定安全的命令（如 <code class="codespan">npm run lint</code>、<code class="codespan">git commit</code>）加入白名单；</li><li class="listitem" style="margin: 0.5em 8px;">• <strong>沙箱</strong>：用系统级隔离限制文件系统和网络，让 Claude 在划定范围内自由执行；</li><li class="listitem" style="margin: 0.5em 8px;">• 对确定安全的流水线（如修 lint、生成样板），可以用 <code class="codespan">--dangerously-skip-permissions</code> 跳过权限确认。</li></ul><p class="p">这样既保证安全，又减少无效打断。</p><hr class="hr" style="height: 1px; border: none; margin: 2em 0; background: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0));"><h2 class="h2" data-heading="true" style="padding: 0.3em 1.2em; font-size: calc(16px * 1.3); border-radius: 8px 24px 8px 24px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);">七、Skills、Subagents、MCP：按需扩展</h2><ul class="ul" style="list-style: none; padding-left: 1.5em;"><li class="listitem" style="margin: 0.5em 8px;">• <strong>Skills</strong>：把项目/团队特有的约定或流程写进 <code class="codespan">.claude/skills/</code> 下的 SKILL.md，需要时用 <code class="codespan">/skill-name</code> 调用，不必塞进 CLAUDE.md。</li><li class="listitem" style="margin: 0.5em 8px;">• <strong>Subagents</strong>：在单独上下文中跑，适合「读很多文件做调查」或「专门做安全审查」——探索和审查不会占满主对话的 context。</li><li class="listitem" style="margin: 0.5em 8px;">• <strong>MCP</strong>：连数据库、Figma、工单系统等，让 Claude 直接查数据、看设计、拉需求。</li></ul><p class="p">一句话：<strong>通用、每次对话都要的放 CLAUDE.md；按场景用的放 Skills；重调查、重阅读的交给 Subagents；要连外部系统就用 MCP。</strong></p><hr class="hr" style="height: 1px; border: none; margin: 2em 0; background: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0));"><h2 class="h2" data-heading="true" style="padding: 0.3em 1.2em; font-size: calc(16px * 1.3); border-radius: 8px 24px 8px 24px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);">八、会话管理：早纠偏、勤清上下文</h2><p class="p">对话是持久且可回滚的，可以大胆试，但要会「刹车」和「重启」。</p><ul class="ul" style="list-style: none; padding-left: 1.5em;"><li class="listitem" style="margin: 0.5em 8px;">• <strong>Esc</strong>：中途停掉当前操作，上下文还在，可以立刻改指令。</li><li class="listitem" style="margin: 0.5em 8px;">• <strong>Esc 两次 或 /rewind</strong>：回到之前的对话/代码状态，只恢复对话、只恢复代码或一起恢复都可以。</li><li class="listitem" style="margin: 0.5em 8px;">• 直接说「撤销刚才的修改」让 Claude 回退。</li><li class="listitem" style="margin: 0.5em 8px;">• <strong>/clear</strong>：任务之间清空上下文，避免无关内容把窗口塞满。</li></ul><p class="p">如果同一个问题你已经纠正 Claude 两次以上，往往说明上下文被失败尝试「污染」了。这时更适合 <code class="codespan">/clear</code> 后重开一段对话，用更精确的提示（把你已经学到的约束写进去）再试。<strong>干净会话 + 好提示，通常比在长会话里反复纠错更高效。</strong></p><hr class="hr" style="height: 1px; border: none; margin: 2em 0; background: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0));"><h2 class="h2" data-heading="true" style="padding: 0.3em 1.2em; font-size: calc(16px * 1.3); border-radius: 8px 24px 8px 24px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);">九、避免几种常见失败模式</h2><p class="p">官方文档里总结了几类高频问题，可以对照自检：</p><ul class="ul" style="list-style: none; padding-left: 1.5em;"><li class="listitem" style="margin: 0.5em 8px;">• <strong>厨房水槽式会话</strong>：一个任务里掺进很多无关问题，上下文堆满杂讯。\ <strong>应对</strong>：不相关的任务之间用 <code class="codespan">/clear</code> 隔开。</li><li class="listitem" style="margin: 0.5em 8px;">• <strong>反复纠正同一点</strong>：错了改、改了又错，失败路径占满上下文。\ <strong>应对</strong>：纠正超过两次就 <code class="codespan">/clear</code>，写一条更具体的初始提示再开新会话。</li><li class="listitem" style="margin: 0.5em 8px;">• <strong>CLAUDE.md 写得太长</strong>：规则太多，重点反而不突出。\ <strong>应对</strong>：狠心删；若某条规则必须被遵守，考虑改成 hook 或 Skill，让执行更确定。</li><li class="listitem" style="margin: 0.5em 8px;">• <strong>只信不验</strong>：实现看起来合理，但没跑测试、没检查边界。\ <strong>应对</strong>：尽量给出可验证方式（测试、脚本、截图）；无法验证就别轻易发布。</li><li class="listitem" style="margin: 0.5em 8px;">• <strong>无限探索</strong>：让 Claude「查一下某某」却不限定范围，它可能读几百个文件。\ <strong>应对</strong>：把调查范围收窄，或交给 subagent，把探索隔离在副上下文里。</li></ul><hr class="hr" style="height: 1px; border: none; margin: 2em 0; background: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0));"><h2 class="h2" data-heading="true" style="padding: 0.3em 1.2em; font-size: calc(16px * 1.3); border-radius: 8px 24px 8px 24px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);">十、心法不是铁律，直觉需要自己养</h2><p class="p">上述都是「多数情况下好用」的起点，不是每件事都要照做。有时你需要长会话里累积的历史，有时任务足够小可以跳过规划，有时故意提得模糊一点，反而能看出 Claude 如何理解问题。</p><p class="p">重要的是：<strong>留意什么有效、什么无效。</strong> 当结果很好时，想想是提示结构、给的上下文还是当前模式在起作用；当结果不好时，问一句：是上下文太吵、提示太模糊，还是一次塞的任务太大？<br>时间久了，你会形成自己的直觉——什么时候要具体、什么时候可以开放，什么时候先规划、什么时候先探索，什么时候清上下文、什么时候保留。这些，是任何一篇最佳实践文章都替代不了的。</p><hr class="hr" style="height: 1px; border: none; margin: 2em 0; background: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0));"><h2 class="h2" data-heading="true" style="padding: 0.3em 1.2em; font-size: calc(16px * 1.3); border-radius: 8px 24px 8px 24px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);">拓展阅读</h2><ul class="ul" style="list-style: none; padding-left: 1.5em;"><li class="listitem" style="margin: 0.5em 8px;">• <a href="https://code.claude.com/docs/zh-CN/best-practices" title="Claude Code 官方文档 - 最佳实践" style="color: #576b95; text-decoration: none;">Claude Code 官方文档 - 最佳实践</a></li><li class="listitem" style="margin: 0.5em 8px;">• <a href="https://code.claude.com/docs/zh-CN/how-claude-code-works" title="Claude Code 如何工作" style="color: #576b95; text-decoration: none;">Claude Code 如何工作</a></li><li class="listitem" style="margin: 0.5em 8px;">• <a href="https://code.claude.com/docs/zh-CN/costs#reduce-token-usage" title="减少 token 使用" style="color: #576b95; text-decoration: none;">减少 token 使用</a></li></ul><hr class="hr" style="height: 1px; border: none; margin: 2em 0; background: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0));"><p class="p"><em style="font-style: italic; font-size: inherit;">本文基于 code.claude.com 官方最佳实践文档整理，由 Claude Code 协作完成。</em></p>
    
  
    
  
    
  </section>
  </div>
</body>
</html>